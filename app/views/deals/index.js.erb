$('#slideToggleLink').text("<%= @destination.title_destination %>");
$("#dealsHotelsList").append("<%= j render 'hotels_list' %>");

var currentPageNumber =  $('.deals-page').length;
var nextPageNumber = currentPageNumber + 1;

currentPage = $(".deals-page:last");
previousButton = $(".loadPrevious:last");
nextButton = $(".loadMoreNext:last");
currentPage.attr("data-page", currentPageNumber);

nextButton.attr("data-next-page", nextPageNumber);
previousButton.attr("data-previous-page", currentPageNumber - 1).show();
$('.deals-page').not(currentPage).hide();

$('div.lazy').lazyload({ effect : 'fadeIn' });

$(previousButton).on('click', function(){
  targetPageNumber = $(this).data('previous-page');
  console.log(targetPageNumber);
  targetPage = $(".deals-page[data-page='"+ targetPageNumber +"']");
  targetPage.show();
  $('.deals-page').not(targetPage).hide();
});

$(nextButton).on('click', function(){
  nextPageNumber = $(this).data('next-page');
  console.log(nextPageNumber);
  nextPage = $(".deals-page[data-page='" + nextPageNumber + "']");
  if(nextPage.length > 0){
    nextPage.show()
    $('.deals-page').not(nextPage).hide()
  }else{
    console.log($(this).data('cache-key'));
    console.log($(this).data('cache-location'));
    $.ajax({
      url: '/deals/next',
      type: 'GET',
      data: {
        cache_key: $(this).data('cache-key'),
        cache_location: $(this).data('cache-location')
      }
    });
  }
});
